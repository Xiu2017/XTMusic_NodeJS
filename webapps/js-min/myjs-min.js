var keyword="华晨宇";var limit=20;var offset=1;var type="netease";var endOffset=false;var ended=false;function nextPage(){offset++;search(true)}function search(next){endOffset=true;if(!next){offset=1;window.frames["audiolist"].table.songs=null;if(keyword!=$("#search").val()&&type!=$("#select option:selected").val()){window.frames["audiolist"].num=0;window.frames["audiolist"].lastli=-1;window.frames["audiolist"].$("td").removeAttr("style");window.frames["audiolist"].$("td").removeAttr("value")}}type=$("#select option:selected").val();keyword=$("#search").val();if(keyword==""){keyword="流行"}let url=urlEncode('getMusicList?keyword='+keyword+'&limit='+limit+'&offset='+offset+'&type='+type);$.ajax({url:url,success:function(result){if(result!="-1"){let songs=window.frames["audiolist"].table.songs;let res=JSON.parse(result).songs;if(!songs){window.frames["audiolist"].table.songs=res}else{window.frames["audiolist"].table.songs=songs.concat(res)}if(res.length>=limit){endOffset=false}}}});if(isShow!=1){showLrc()}}function init(){$("#search").focus(function(){inputFocus()});$("#search").blur(function(){inputBlur()});search();$('#search').bind('keypress',function(event){if(event.keyCode=="13"){$('#search_button').click()}});$("#select").change(function(){search();changeTheme(type)});changeTheme(type)}function inputFocus(){$("#search").attr("placeholder","")}function inputBlur(){$("#search").attr("placeholder","歌名/歌手/专辑")}function addlist(){window.frames["audiolist"].document.getElementById("files").click()}document.onkeydown=function spacePlay(event){var e=event||window.event||arguments.callee.caller.arguments[0];var search=document.getElementById("search");if(search==document.activeElement)return;if(e&&e.keyCode==32){play_pause();e.preventDefault()}};function hiddenwin(){$("#selecttime,#selectmode").css("display","none")}function play_pause(){var play=document.getElementById("play");var audio=window.frames["audiolist"].document.getElementById("audio");var protime=document.getElementById("pro_time");var vinyl=document.getElementById("vinyl");var vinylheader=document.getElementById("vinylheader");if(!audio.src){window.frames["audiolist"].changeSrc(1,0);return}if(audio.paused){audio.play();window.frames["audiolist"].playgif(1);vinyl.style.animationPlayState="running";vinylheader.style.animation="vinyldown 300ms forwards";play.innerHTML="&#xe82f;";play.style.paddingLeft="0px";play.style.width="44px";protime.style.display="block";clearInterval("play_time()");setInterval("play_time()",500);return}audio.pause();window.frames["audiolist"].playgif(0);vinyl.style.animationPlayState="paused";vinylheader.style.animation="vinylup 300ms forwards";play.innerHTML="&#xe831;";play.style.paddingLeft="2px";play.style.width="42px";clearInterval("play_time()")}var nownum=0;function play_last(){nownum=window.frames["audiolist"].lastli;window.frames["audiolist"].changeSrc(window.frames["audiolist"].mode,nownum-1)}function play_next(){nownum=window.frames["audiolist"].lastli;window.frames["audiolist"].changeSrc(window.frames["audiolist"].mode,nownum+1)}function play_time(){var play=document.getElementById("play");var audio=window.frames["audiolist"].document.getElementById("audio");var songtime=document.getElementById("song_time");var protime=document.getElementById("pro_time");var probar=document.getElementById("pro_bar");var songname=document.getElementById("song_name");var minc=Math.floor(Math.round(audio.currentTime)/60);if(minc<10)minc="0"+minc;var secc=Math.round(audio.currentTime)%60;if(secc<10)secc="0"+secc;var mind=Math.floor(Math.round(audio.duration)/60);if(isNaN(mind))mind="00";else if(mind<10)mind="0"+mind;var secd=Math.round(audio.duration)%60;if(isNaN(secd))secd="00";else if(secd<10)secd="0"+secd;songtime.innerText=minc+":"+secc+"/"+mind+":"+secd;var marginleft=668/audio.duration;protime.style.marginLeft=Math.round(marginleft*audio.currentTime*100)/100+"px";probar.style.backgroundSize=Math.round(marginleft*audio.currentTime*100)/100+5+"px 4px";if(audio.ended&&!ended&&window.frames["audiolist"].mode==2){ended=true;window.frames["audiolist"].changeSrc(2,window.frames["audiolist"].num)}else if(audio.ended&&!ended){ended=true;play_next()}}var temp_vol=0;var temp_html="";var temp_ml="";var temp_bgs="";var temp_si="";var temp_dec=false;function mute(){var audio=window.frames["audiolist"].document.getElementById("audio");var vol=document.getElementById("volume");var valbar=document.getElementById("volbar");var volvalue=document.getElementById("volvalue");if(temp_dec)return;if(audio.volume>0){temp_dec=true;temp_vol=audio.volume;temp_html=vol.innerHTML;temp_ml=volvalue.style.marginLeft;temp_bgs=valbar.style.backgroundSize;clearInterval(temp_si);temp_si=setInterval(function(){if(audio.volume>0&&audio.volume<0.02){audio.volume=0}else if(audio.volume>0){audio.volume-=0.01}else{temp_dec=false;clearInterval(temp_si)}},6);vol.innerHTML="&#xe800";volvalue.style.marginLeft=0+"px";valbar.style.backgroundSize=0+"px"}else{temp_dec=true;clearInterval(temp_si);temp_si=setInterval(function(){if(audio.volume<temp_vol){audio.volume+=0.01}else{temp_dec=false;clearInterval(temp_si)}},6);vol.innerHTML=temp_html;volvalue.style.marginLeft=temp_ml;valbar.style.backgroundSize=temp_bgs}}function setVolume(){var audio=window.frames["audiolist"].document.getElementById("audio");var vol=document.getElementById("volume");var valbar=document.getElementById("volbar");var volvalue=document.getElementById("volvalue");volvalue.style.marginLeft=event.offsetX+"px";valbar.style.backgroundSize=event.offsetX+"px";audio.volume=1/100*event.offsetX;if(audio.volume<=0.05){audio.volume=0;vol.innerHTML="&#xe800"}else if(audio.volume>0.5){vol.innerHTML="&#xe803"}else{vol.innerHTML="&#xe802"}}function bar_val(){var audio=window.frames["audiolist"].document.getElementById("audio");var protime=document.getElementById("pro_time");var probar=document.getElementById("pro_bar");if(audio.duration){protime.style.marginLeft=event.offsetX-2+"px";probar.style.backgroundSize=event.offsetX-2+"px";audio.currentTime=(audio.duration/668)*event.offsetX}window.frames["audiolrc"].playlrc(1)}function closeDown(){var audio=window.frames["audiolist"].document.getElementById("audio");if(!audio.paused){play_pause()}}function timeOff(){var selecttime=document.getElementById("selecttime");$("#selectmode").css("display","none");if(selecttime.style.display=="none"){selecttime.style.display="block"}else if(selecttime.style.display=="block"){selecttime.style.display="none"}else{selecttime.style.display="block"}}var timing;function setTimeOff(timemin){time=timemin*60;clearInterval(timing);var selecttime=document.getElementById("selecttime");var st=document.getElementsByClassName("showtime")[0];var ct=document.getElementsByClassName("cleartime")[0];st.style.color="#FFF";st.innerText=convertTime(time--);selecttime.style.display="none";st.style.display="inline";ct.style.display="inline";timing=setInterval(function(){if(time<0){clearInterval(timing);closeDown();return}st.innerText=convertTime(time);time--},1000)}function cleartime(){clearInterval(timing);var st=document.getElementsByClassName("showtime")[0];var ct=document.getElementsByClassName("cleartime")[0];st.style.display="none";ct.style.display="none"}function convertTime(time){var hou=Math.floor(time/3600);if(hou==0)hou="";else if(hou<10)hou="0"+hou+":";else if(hou>=10)hou=hou+":";var min=Math.floor(time/60-Math.floor(time/3600)*60);if(min<10)min="0"+min;var sec=Math.round(time)%60;if(sec<10)sec="0"+sec;return hou+""+min+":"+sec}function setPlayMode(mode){var playmode=document.getElementById("playmode");var selectmode=document.getElementById("selectmode");var state=selectmode.style.display;$("#selecttime").css("display","none");switch(mode){case 0:if(state=="none")selectmode.style.display="block";else if(state=="block")selectmode.style.display="none";else selectmode.style.display="block";break;case 1:selectmode.style.display="none";playmode.innerHTML="&#xe83f";window.frames["audiolist"].mode=1;break;case 2:selectmode.style.display="none";playmode.innerHTML="&#xe840";window.frames["audiolist"].mode=2;break;case 3:selectmode.style.display="none";playmode.innerHTML="&#xe83e";window.frames["audiolist"].mode=3;break}}var isShow=1;function showLrc(){var flashSpeed=500;if(isShow==1){$('#center_left').animate({'width':'0px'},flashSpeed);$('#center_right').animate({'width':'999px'},flashSpeed);$('#vinylheader').animate({'width':'120px','height':'180px','marginLeft':'-510px','marginTop':'-404px'},flashSpeed);$('#vinyl').animate({'marginLeft':'-690px','marginTop':'80px','width':'300px','height':'300px'},flashSpeed);$('#vinylimg').animate({'borderRadius':'102px','width':'204px','height':'204px','marginTop':'48px'},flashSpeed);$('.open').animate({'marginTop':'230px'},flashSpeed);$('.open').html('&#xf105;');$('#center_right iframe').animate({'width':'500px','height':'410px','marginTop':'36px','marginRight':'-180px'},flashSpeed);$('#audiolrc').contents().find('body').animate({'width':'500px','marginLeft':'-20px'},flashSpeed);$('#audiolrc').contents().find('html').attr({onmouseover:"showdelrc(1)",onmouseout:"showdelrc(0)"});$('#audiolrc').contents().find('ul').animate({'margin':'260px 0px 260px 0px'},flashSpeed);$('#audiolrc').contents().find('#nolrc').animate({'marginTop':'60px','fontSize':'32px'},flashSpeed);window.frames["audiolrc"].maxsize=20;isShow=0}else{$('#center_left').animate({'width':'767px'},flashSpeed);$('#center_right').animate({'width':'232px'},flashSpeed);$('#vinylheader').animate({'width':'54px','height':'86px','marginLeft':'150px','marginTop':'-190px'},flashSpeed);$('#vinyl').animate({'width':'160px','height':'160px','marginLeft':'35px','marginTop':'20px'},flashSpeed);$('#vinylimg').animate({'borderRadius':'54px','width':'108px','height':'108px','marginTop':'26px'},flashSpeed);$('.open').animate({'marginTop':'-250px'},flashSpeed);$('.open').html('&#xf104;');$('#center_right iframe').animate({'width':'230px','height':'260px','marginTop':'-30px','marginRight':'0px'},flashSpeed);$('#audiolrc').contents().find('body').animate({'width':'189px','marginLeft':'0px'},flashSpeed);$('#audiolrc').contents().find('html').removeAttr('onmouseover','onmouseout');$('#audiolrc').contents().find('ul').animate({'margin':'145px 0px'},flashSpeed);$('#audiolrc').contents().find('#nolrc').animate({'marginTop':'0px','fontSize':'18px'},flashSpeed);window.frames["audiolrc"].maxsize=14;isShow=1;window.frames["audiolrc"].playlrc(1)}if(window.frames["audiolrc"].songlrc){window.frames["audiolrc"].liarray[0]=parseInt($('#audiolrc').contents().find("ul li:eq(0)").get(0).offsetHeight);for(var i=1;i<=window.frames["audiolrc"].lrctime.length-1;i++){window.frames["audiolrc"].liarray[i]=window.frames["audiolrc"].liarray[i-1]+parseInt($('#audiolrc').contents().find("ul li:eq("+i+")").get(0).offsetHeight)}}if(isShow==0)window.frames["audiolrc"].playlrc(1)}function openlrc(num){if(num==1){document.getElementsByClassName("open")[0].style.display="block"}else{document.getElementsByClassName("open")[0].style.display="none"}}$(window).bind('beforeunload',function(){return'您可能有数据没有保存'});function urlEncode(url){url=encodeURIComponent(url);url=url.replace(/\%3A/g,":");url=url.replace(/\%2F/g,"/");url=url.replace(/\%3F/g,"?");url=url.replace(/\%3D/g,"=");url=url.replace(/\%26/g,"&");return url}
